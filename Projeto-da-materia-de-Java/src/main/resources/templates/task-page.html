<!DOCTYPE html>
<html lang="pt" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Lista de Tarefas do Windows XP</title>
</head>
<body>

<h2 th:text="'Bem-vindo, ' + ${username} + '!'">Bem-vindo, Gustavo!</h2>
<p>Esta é a sua lista de tarefas pessoal.</p>

<hr/>

<h3>Nova Tarefa</h3>
<form th:action="@{/task/new}" th:object="${newTask}" method="post">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    <input type="text" th:field="*{descricao}" placeholder="Descreva a nova tarefa" required>
    <button type="submit">Adicionar</button>
</form>

<hr/>

<h3>Filtros</h3>

<span style="margin-right: 15px;">
    <a th:href="@{/task}"
       th:style="${currentFilter == 'all' or currentFilter == null} ? 'font-weight: bold; color: blue;' : ''">
        Todas
    </a>
</span>

<span style="margin-right: 15px;">
    <a th:href="@{/task(filter='uncompleted')}"
       th:style="${currentFilter == 'uncompleted'} ? 'font-weight: bold; color: blue;' : ''">
        Pendentes
    </a>
</span>

<span style="margin-right: 15px;">
    <a th:href="@{/task(filter='completed')}"
       th:style="${currentFilter == 'completed'} ? 'font-weight: bold; color: blue;' : ''">
        Concluídas
    </a>
</span>

<hr/>
<h3>Minhas Tarefas</h3>

<div th:if="${tasks.isEmpty()}">
    <p th:if="${currentFilter == 'all' or currentFilter == null}">Você não tem tarefas registradas ainda.</p>
    <p th:if="${currentFilter == 'completed'}">Nenhuma tarefa foi concluída.</p>
    <p th:if="${currentFilter == 'uncompleted'}">Parabéns! Nenhuma tarefa está pendente.</p>
</div>

<ul th:unless="${tasks.isEmpty()}">
    <li th:each="task : ${tasks}">

        <span th:text="${task.descricao}"
              th:style="${task.concluido ? 'text-decoration: line-through; color: gray;' : 'font-weight: bold;'}">
            Descrição da Tarefa
        </span>

        <form th:action="@{/task/toggle/{id}(id=${task.id})}" method="post" style="display: inline;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <button type="submit" th:text="${task.concluido ? 'Desmarcar' : 'Concluir'}"></button>
        </form>

        <form th:action="@{/task/delete/{id}(id=${task.id})}" method="post" style="display: inline;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <button type="submit" onclick="return confirm('Tem certeza que deseja deletar?');">Excluir</button>
        </form>

    </li>
</ul>

<hr/>

<div th:unless="${tasks.isEmpty()}">
    <h3>Ações em Massa</h3>

    <form th:action="@{/task/complete-all}" method="post" style="display: inline;">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <button type="submit">Concluir Todas</button>
    </form>

    <form th:action="@{/task/delete-all}" method="post" style="display: inline;">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <button type="submit" onclick="return confirm('ATENÇÃO! Tem certeza que deseja DELETAR TODAS as tarefas?');">Excluir Todas</button>
    </form>
</div>
<hr/>

<form th:action="@{/logout}" method="post">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    <button type="submit">Fazer Logout</button>
</form>

</body>
</html>